version 15

//reorder variables how I like them...
order INTNAME-CONSENT first
order PID first
order RESPOSNEID after PID


//label variables and values, drop unneccessary variables
lab var STARTDATE "Survey start date, qualtrics timestamp"
lab var ENDDATE "Survey end date, qualtrics timestamp"
lab var STATUS "qualtrics status"
lab var IPADDRESS "IP address for survey administration"
lab var PROGRESS "Percent of survey complete"
lab var DURATIONINSECONDS "Duration (in seconds) of survey administration"
lab var FINISHED "survey finished y/n"
lab var RECORDEDDATE "recorded date timestamp (qualtrics generated)"
lab var RESPONSEID "unique qualtrics response ID"

drop RECIPIENTLASTNAME
drop RECIPIENTFIRSTNAME
drop RECIPIENT EMAIL
drop EXTERNALREFERENCE

lab var LOCATIONLATITUDE "Location of survey - latitude"
lab var LOCATIONLONGITUDE "Location of survey - longitude"
lab var DISTRIBUTIONCHANNEL "Qualtrics Distrubution Channel (anonymous link/preview link/etc)"
lab var USERLANGUAGE "User language"
lab var INTNAME "Interviewer Name"
lab var DATE "Interview date (entered by interviewer MM/DD/YYYY)"
lab var PID "Participant ID"

lab var SURVEY-TYPE "Survey type, housed/not housed"
lab def SURVEY-TYPE_LAB 1"Housed" 2"Unhoused" -99"Seen but not answered"
lab val SURVEY-TYPE SURVEY-TYPE_LAB

//make sure to add new sites as we go. 
lab var SITE_HOUSED "Recruitment site, housed"
lab def SITE_HOUSED_LAB 1"Jovenes TLP" 2"Jovenes SH (Progress Place)" 4"Jovenes Scattered Site SH" 5"CRCD Epworth Apts SH" 6"CRCD 28th Street Apts SH" 7"Young Burlington SH" 8"Covenant House TLP" 9"Ruth's Place TLP" 77"Other (please specify) -99"Seen but not answered", modify
lab val SITE_HOUSED SITE_HOUSED_LAB

lab var SITE_UNHOUSED "Recruitment site, unhoused"
lab def SITE_UNHOUSED_LAB 1"Jovenes ES" 2"Jovenes-OTHER" 4"CRCD Ruth's Place Drop-in" 77"Other, (please specify)" -99"Seen but not answered"
lab val SITE_UNHOUSED SITE_UNHOUSED_LAB


lab var CONSENTCOMP "Consent comprehension questions asked y/n"
lab def YNONLY_LAB 1"Yes" 0"No" -99"Seen but not answered"
lab val CONSENTCOMP YNONLY_LAB

lab var CONSENT "Consent signed y/n"

lab var DOB "birthdate"

lab var HISP "hispanic/latino"
lab def YN-DK_LAB 1"Yes" 0"No" 99"Don't know" -99"Seen but not answered"
lab val HISP YN_DK_LAB

lab var RACE "race"
lab def RACE_LAB 1"American Indian or Alaska Native" 2"Asian" 3"Black or African American" 4"Native Hawaiian or other Pacific Islander" 5"South Asian" 6"White" 7"Bi/Multi Racial or Ethnic" 8"Other, please specify" 99"I don't know"
lab val RACE RACE_LAB

rename RACE_8_TEXT RACE_OTHER
lab var RACE_OTHER "Race_other (text entry)"

INSCHOOL
INSCHOOL_TYPE
EDUC
SEX
GENDER
SEXORI
SEXATTR
RESEARCH_INST
RESEARCH_LAST
RESEARCH_TYPES
RESEARCH_PASTYR
ROMREL_HEADER
ROMREL_MARR
ROMREL_CURR
ROMREL_PTNRS
ROMREL_PTNRSGNDR
ROMREL_DUR
ROMREL_SEX
HOUSING_INST
FIRSTHOMELESS
REASONHOMELESS
HOUSINGPROGS_EVER
TIMEHOMELESS_EVER
TIMEHOUSED
STAYBEFOREHOUSED
TIMEHOMELESS_BEFOREHOUSED
TIMEHOMELESS_RECENT
FC_EVER
FC_PLACEMENTS
JJS_EVER
JJS_AGEOUT
ARREST_EVER
JAIL_EVER
STRESS_STREETS
MSE_INST
MSE_REL-PROV
MSE_TALKTO
MSE_HOUSINGOPTS
MSE_PROGENGAGE
MSE_DROP-INACCESS
MSE_SHELTERACCESS
MSE_TXACCESS
INCOMEEMPL_CONFIDENT
INCMGEN_30DAY
EMPLOY_PAIDJOBS
EMPLOY_TTLPAIDHRS
TTLINCOME_EMPLOY
TTLINCOME_INFORMAL
UCLA_PTSD_INST
UCLA_PTSD_DISASTER
UCLA_PTSD_ACCIDENT
UCLA_PTSD_WAR
UCLA_PTSD_PHYSABUSE
UCLA_PTSD_WITNESS
UCLA_PTSD_COMMVICT
UCLA_PTSD_COMMWIT
UCLA_PTSD_DEADBODY
UCLA_PTSD_SEXABUSE
UCLA_PTSD_FAMILYVICT
UCLA_PTSD_INJURY
UCLA_PTSD_FORCEDSEX
UCLA_PTSD_DEATH
PH_INST
HEALTH
CHRONICDX
HEALTHNEEDS
SD_SF4A
SD_SF1
SD_SF2
SD_SF3
SD_SF4
SD_SINCE
ISI7_SRI
ISI7-SRI_SINCE
SLEEP_SAFE
PHQ-9_INST
PHQ9_1
PHQ9_2
PHQ9_3
PHQ9_4
PHQ9_5
PHQ9_6
PHQ9_7
PHQ9_8
PHQ9_9
GAD7_1
GAD7_2
GAD7_3
GAD7_4
GAD7_5
GAD7_6
GAD7_7
GAD7_8
PTSD_1
PTSD_2
PTSD_3
PTSD_4
MH_DX
MH_DX_OTHER
MH_CURRENT
SUIC_INST
SUIC_THOUGHT
SUIC_ATTEMPT
MHC_INST
MED_12MO
THER_12MO
ER_12MO
HOSPIT_12MO
UNMET_12MO
MHNEED_PERCEIVE
DERS-SF
PSS_INST
PSS_1
PSS_2
PSS_3
PSS_4
COPING
HALFWAY_BREAK
SEXINST_CONF
LIFESEX_BEH
LIFESEX_PARTNUM
3MO.SEX_INST
DESCRIBE_3MOPARTNER
3MOSEX_PARTGNDR
3MOSEX_TYPES
3MOSEX_PARTNUM
3MOSEX_PARTBIOSEX
3MOSEX_CONDOMFREQ
3MOSEX_CNTRCPTV
3MOSEX_CNTRCPTV_FAM
3MOSEX_CNTRCPTV_PLAN
3MOSEX_SUIFREQ
3MOSEX_HIVCONVO
EXCHSEX_3MO
EXCHSEX_TYPES
EXCHSEX_3MO_FORCED
FORCEDSEX_3MO
FORCEDSEXATTEMPT_3MO
HIVSTI_INST_CONF
HIV_ST
HIVP_WHEN
HIVP_TESTLOC
HIVP_TX
HIVP_TX_WHYNOT
HIVP_MEDS
HIVP_MEDS_WHYNOT
HIVN_LASTTEST
HIVN_TESTLOC
HIVN_GOTRESULT
HIVN_PTCOUNSEL
STI_LAST
STI-POS
CHLAM_POS_LAST
GONO_POS_LAST
SYPH_POS_LAST
HERP_POS_LAST
HPV_POS_LAST
HEPB_POS_LAST
STI_POS_OTHER
OTHER_POS_LAST
HCV_INST
HCV_LASTTEST
HCV_STATUS
PREP_INST
PREP_KNOW
PREP_INTEREST
PREP_WHERELEARNED
PREP_SOCIAL
PREP_SOCIAL_WHO
PREP_RX_EVER
PREP_CURRENTLYTAKING
PREP_BARRIERS
PREG_INST
PREG_FREQ
PREG_UNPLAN
PREG_CHILD
PREG_LIVE
SU_INST
SUTYPES_EVER
OTHERSU_TYPE
TOBACCO_LAST
TOBACCO_TYPES
TOBACCO_SMOKEFREQ
TOBACCO_DAILYAMT
TOBACCO_WEEKLYAMT
TOBACCO_SMOKELESSFREQ
TOBACCO_VAPEFREQ
ALC_LAST
ALC_30
ALC_30_BINGE_F
ALC_30_BINGE_M
MARJ_LAST
MARJ_30
MARJ_30_TYPES
MARJ_30_ROA
MARJ_FREQCURR
MARJ_HPD30D
MARJ_FREQACCPT
MARJ_AMTWK
MARJ_ACCESS
MARJ_CARD
METH_LAST
METH_30
METH_30_ROA
MDMA_LAST
MDMA_30
MDMA_30_ROA
SYNTHMJ_LAST
SYNTHMJ_30
HALLUC_LAST
HALLUC_30
HALLUC_30_TYPES
PDM_INSTR
PDM_LAST
PDM_30
PDM_30_ROA
PDM_30_TYPES
HEROIN_LAST
HEROIN_30
HEROIN_30_ROA
COCAINE_LAST
COCAINE_30
COCAINE_30_ROA
CRACK_LAST
CRACK_30
CRACK_30_ROA
INHAL_LAST
INHAL_30
STEROID_LAST
STEROID_30
STEROID_30_ROA
NITROUS_LAST
NITROUS_30
KETA_LAST
KETA_30
PCP_LAST
PCP_30
PCP_30_ROA
OTHERSU_LAST
OTHERSU_30
OTHERSU_30_ROA
IVDU_NEEDLEEXCH
IVDU_NEEDLEPURCH
EXCH_30DAYS
EXCH_WHERE
IVDU_EVER
IVDU_30DAY
IVDU_SHARE
IVDU_REUSE
IVDU_REUSE_QUANT
SUTX_EVER
SUTX_PASTYEAR
CAGE2
CAGE1
CAGE3
CAGE4
SUCOST_30D_ALCOHOL
SUCOST_30D_MARJ
SUCOST_30D_ILDRUG
TECH_INST
TECHACCESS
TECH_ACCESS_NOOWN
TECH_ACCESS_WHERE
CELL_PLAN
CELL_BILL
CELL_TURNOVER
CELL_USE
CELL_CHARGE
CELL_CHARGE_ACCESS
TECH_BARRIERS
VICT_INSTRUCT
VICT_ROBBERY
VICT_IPV_VIC
VICT_IPV_PERP
VICT_ASSLT
VICT_ASSLT_PERP
GANG_INST_CONF
GANG_CURR
GANG_FRMR
GANG_AGE
GANG_AFF
STREETFAMILY
POLICEINTGEN
POLICEINT_3MO
POLICEINT_3MO_EXP
POLICEIN_3MO_WHY
AVOIDPOLICE
CASEY_INST_INTRO
CASEY_LOCUSCONTROL
CASEY_FUTURETHINK
CASEY_RELATIONSHIPS
CASEY_MODELING
CASEY_SUCCESSREL
CASEY_TRANSITION
CASEY_PRIDE
CASEY_SELFEFFICACY
Q523
Q524



/*Delete all test responses*/
drop if RESPONSEID == "R_3dLBmeVaJN1KDsD" | RESPONSEID == "R_3HRMuFtiDaFj7RD"


/*Recode incorrect PIDs: 1 of 2 1024's to 2017; 2 BL onlys to 4008 and 4016; 1 of 2 1034's to 1036*/
replace PID = 2017 if RESPONSEID == "R_1GUHNGNcf1AYuJY"
replace PID = 4008 if RESPONSEID == "R_1exDzqYGNb34xQq"
replace PID = 4016 if RESPONSEID == "R_1Fb1Tth45hmne1q"	
replace PID = 1036 if RESPONSEID == "R_2PmUtgGazr5a8z7"


// clean recode "other" recruitment site entries
/* first for YB */
replace SITE_HOUSED = 7 if PID == 1034
replace SITE_HOUSED = 7 if PID == 1035
replace SITE_HOUSED = 7 if PID == 1036
replace SITE_HOUSED = 7 if PID == 1037
replace SITE_HOUSED = 7 if PID == 1038
replace SITE_HOUSED = 7 if PID == 1039
replace SITE_HOUSED = 7 if PID == 1040
replace SITE_HOUSED = 7 if PID == 1041
replace SITE_HOUSED = 7 if PID == 1042
replace SITE_HOUSED = 7 if PID == 1043
replace SITE_HOUSED = 7 if PID == 1044

/*ruth's place TLP */
replace SITE_HOUSED = 9 if PID == 1020
replace SITE_HOUSED = 9 if PID == 1021
replace SITE_UNHOUSED = . if PID == 1021

//Combine partial surveys:
/* combine 1004's two surveys into one (response ID "R_1o0ursi841wl4tT" is first half;  "R_72GUjPfXIWKYOlP" is second half) */ 

/* combine 1014's two surveys or drop one of the two: "R_eaPtOykJQhKLnOh" "R_3nvdffglc9gRmC7" */


// Make known changes to baseline survey responses:
/* fix 4008's (formerly 2008's) SUcost_30d_marj response to $20 or more (but don't have that response option... $50 or less? --> */ 
replace SUCOST_30DMARJ = . 

/* fix 2002's resposne to alc_30_binge_m to 0 */ 
replace ALC_30_BINGE_M = 0 if responseid == "R_2pKaU8QjbpCuDr9" & pid == 2002



/* merge in other surveys from other files? */ 


